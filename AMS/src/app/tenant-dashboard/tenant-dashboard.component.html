<div class="dashboard-container">
    <!-- Top Header -->
    <div class="header">
      <div class="user-info">
        <h1>{{ userProfile?.fullname }} </h1>
        <p>Room: {{ tenant.room || 'Not Assigned' }}</p>
      
      </div>
      <div class="balance-info">
        <p>Outstanding Balance</p>
        <h1>â‚±{{ tenant.rent || 0 }}</h1>
        <p>Due Date: {{ tenant.due_date | date:'MMMM dd, yyyy' }}</p>
        <button class="pay-now-btn" (click)="isPaymentFormVisible = true">Pay Now</button>
      </div>
    </div>



<!-- Payment Form (Hidden until Pay Now is clicked) -->
<div *ngIf="isPaymentFormVisible" class="payment-details-wrapper">
  <h2>Payment Details</h2>

  <form (ngSubmit)="onPayInvoice()">
    <div>
      <label for="paymentMethod">Payment Method</label>
      <select id="paymentMethod" [(ngModel)]="selectedPaymentMethod" name="paymentMethod">
        <option value="onhand">Pay On-Hand</option>
        <option value="qr">Pay via QR</option>
      </select>
    </div>

    <!-- Show QR image if Pay via QR is selected -->
    <div *ngIf="selectedPaymentMethod === 'qr'">
      <h3>Scan this QR Code to Pay</h3>
      <div *ngIf="imageInfos && imageInfos.length > 0">
        <img *ngFor="let image of imageInfos" [src]="image.img" alt="QR Code" class="img-thumbnail" height="150px" />
      </div>
    </div>

    <div>
      <label for="amount">Amount</label>
      <input type="number" id="amount" [(ngModel)]="paymentAmount" name="amount" [readonly]="true" />
    </div>

    <div *ngIf="selectedPaymentMethod === 'onhand'">
      <label for="referenceNumber">Reference Number</label>
      <input type="text" id="referenceNumber" [(ngModel)]="paymentReferenceNumber" name="referenceNumber" />
    </div>

    <div>
      <label for="proofOfPayment">Proof of Payment</label>
      <input type="file" (change)="onPaymentProofFileSelected($event)" id="proofOfPayment" name="proofOfPayment" />
    </div>

    <button type="submit">Submit Payment</button>
  </form>

  <p *ngIf="paymentMessage">{{ paymentMessage }}</p>
</div>


<div class="tenant-grid-container">
    <!-- Grid Section -->
    <div class="grid-container">
      <button class="grid-item" (click)="openProfileModal()">
        <i class="material-icons">person</i>
        <p>Profile</p>
      </button>
      <button class="grid-item" (click)="openPayHistoryModal()">
        <i class="material-icons">receipt</i>
        <p>Payment History</p>
      </button>
      <button class="grid-item" (click)="openLeaseModal()">
        <i class="material-icons">home</i>
        <p>Lease Agreement</p>
      </button>
      <button class="grid-item" (click)="openConcernsModal()">
        <i class="material-icons">mail</i>
        <p>Inquiries</p>
      </button>
    </div>

<!-- Modal For Concerns -->
<div class="modal" id="ConcernsModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h2>Create a New Concern</h2>
        <button type="button" class="btn-close" (click)="closeConcernsModal()"></button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <form (ngSubmit)="createConcern()">
          <div class="form-group">
            <label for="subject">Subject</label>
            <input
              type="text"
              id="subject"
              required
              class="form-control"
              placeholder="Subject"
              [(ngModel)]="concerntitle"
              name="subject"
              #subjectInput="ngModel"
            />
            <div *ngIf="subjectInput.invalid && subjectInput.touched" class="error-message">
              Subject is required.
            </div>
          </div>
          <div class="form-group">
            <label for="description">Description</label>
            <textarea
              id="description"
              required
              class="form-control"
              placeholder="Description"
              [(ngModel)]="concerncontent"
              name="description"
              #descriptionInput="ngModel"
            ></textarea>
            <div *ngIf="descriptionInput.invalid && descriptionInput.touched" class="error-message">
              Description is required.
            </div>
          </div>
          <div class="form-group">
            <label for="attachment">Attachment</label>
            <input
              type="file"
              id="attachment"
              class="form-control"
              (change)=" onImageFileSelected($event)"
            />
          </div>
          <button type="submit" class="btn btn-primary" [disabled]="!concerntitle || !concerncontent">
            Submit Concern
          </button>
        </form>
        <p *ngIf="message">{{ message }}</p>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>
<!--End of Concerns Modal-->

<!-- Modal For Profile -->
<div class="modal" id="ProfileModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h2>Create a New Concern</h2>
        <button type="button" class="btn-close" (click)="closeProfileModal()"></button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        
      <!-- Modal Footer -->
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>
</div>
<!--End of Lease Modal-->

<!-- Modal For Lease -->
<div class="modal" id="LeaseModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h2>Create a New Concern</h2>
        <button type="button" class="btn-close" (click)="closeLeaseModal()"></button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        
      <!-- Modal Footer -->
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>
</div>
<!--End of Lease Modal-->


<!-- Modal For Pay History -->
<div class="modal" id="PayHistoryModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h2>Create a New Concern</h2>
        <button type="button" class="btn-close" (click)="closePayHistoryModal()"></button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        
      <!-- Modal Footer -->
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>
</div>
<!--End of Lease Modal-->

    </div>
    </div>